
<!DOCTYPE HTML>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html" charset="UTF-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
	<meta charset="utf-8">
	<title>Essential Mozilla Command Line | creativepsyco's Blog</title>

	<meta name="author" content="Mohit Kanwal">
	
	<meta name="description" content="A Blog of all things digital">

	<meta name="HandheldFriendly" content="True" />
	<meta name="MobileOptimized" content="320" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />

	<link href="/atom.xml" rel="alternate" title="creativepsyco's Blog" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.png" rel="shortcut icon">
	<link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic|Open+Sans:700,400" />
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/.min.css" />
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
</head>


<body class="post-template">
  <main class="content" role="main"><article class="post">
  
	<header class="post-header">
		<a id="blog-logo" href="/">creativepsyco's Blog</a>
	</header>
	<span class="post-meta">11 Jan 2013</span>
	<h1 class="post-title">Essential Mozilla Command Line</h1>

	<section class="post-content">
		<p><em>This is a reference of some of the very important mozilla commands that I use in daily Terminal Life</em></p>

<h3>Requirements</h3>

<p>Set up Hg, Autoconf using Brew. Look up the instructions at the official website.</p>

<h3>Setting up of Source Directory</h3>

<p>Mozilla Code can be checked out from <a href="http://hg.mozilla.org.">http://hg.mozilla.org.</a> To set up a Thunderbird and Calendar clone on your local machine checkout the source code as</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>bash$ hg clone http://hg.mozilla.org/comm-central</span></code></pre></td></tr></table></div></figure>


<p>This will create a <code>comm-central</code> directory in your local machine
Now <code>comm-central</code> depends on a number of submodules which can be fetched by the following commands</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>bash<span class="nv">$ </span><span class="nb">cd </span>comm-central
</span><span class='line'>bash<span class="nv">$ </span>python client.py checkout
</span></code></pre></td></tr></table></div></figure>


<p>This will fetch the submodules. It will take a while</p>

<h3>Compiling Code</h3>

<p>In order to build the calendar application create a <code>.mozconfig</code> file within <code>comm-central</code> and insert the following code:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>mk_add_options <span class="nv">MOZ_OBJDIR</span><span class="o">=</span>@TOPSRCDIR@/obj-TB
</span><span class='line'>mk_add_options <span class="nv">AUTOCONF</span><span class="o">=</span>/usr/local/Cellar/autoconf213/2.13/bin/autoconf213
</span><span class='line'>ac_add_options --enable-calendar
</span><span class='line'>
</span><span class='line'><span class="c"># Turn off compiler optimization. This will make applications run slower,</span>
</span><span class='line'><span class="c"># will allow you to debug the applications under a debugger, like GDB.</span>
</span><span class='line'>ac_add_options --disable-optimize
</span><span class='line'>ac_add_options --disable-jemalloc
</span><span class='line'>
</span><span class='line'><span class="c"># -s makes builds quieter by default</span>
</span><span class='line'><span class="c"># -j4 allows 4 tasks to run in parallel. Set the number to be the amount of</span>
</span><span class='line'><span class="c"># cores in your machine. 4 is a good number.</span>
</span><span class='line'>
</span><span class='line'>mk_add_options <span class="nv">MOZ_MAKE_FLAGS</span><span class="o">=</span><span class="s2">&quot;-j4 -s --no-print-directory&quot;</span>
</span><span class='line'>mk_add_options <span class="nv">JS_READLINE</span><span class="o">=</span>1
</span><span class='line'><span class="nb">export </span><span class="nv">JS_READLINE</span><span class="o">=</span>1
</span><span class='line'>ac_add_options --disable-tests
</span><span class='line'>ac_add_options --disable-installer
</span></code></pre></td></tr></table></div></figure>


<p>Now fire away the compiler using the following command:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>bash<span class="nv">$ </span>make -f client.mk
</span></code></pre></td></tr></table></div></figure>


<p>This will take quite a lot of time depending upon your machine&rsquo;s strength of course.</p>

<h3>Applying a patch</h3>

<p>From time to time, you might need to apply a patch from someone else, or maybe your own patch. This is quite easy, but note that if you plan on applying the patch, making some changes and then want to create a patch that doesn&rsquo;t contain the patch you originally applied, it might be quite a bit harder.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nb">cd</span> <span class="nv">$MOZILLA</span>/calendar
</span><span class='line'><span class="c"># --dry-run tests the patching process to ensure that the patch will go</span>
</span><span class='line'><span class="c"># ahead cleanly. Be sure to run --dry-run at least once before running</span>
</span><span class='line'><span class="c"># the actual patching process.</span>
</span><span class='line'>patch -p1 -i ~/my_first_bug.diff --dry-run
</span><span class='line'><span class="c"># Now check if the patch applies cleanly, or you are willing to fix the </span>
</span><span class='line'><span class="c"># places it went wrong. When you are confident, you can call:</span>
</span><span class='line'>patch -p0 -i ~/my_first_bug.diff
</span><span class='line'>
</span><span class='line'><span class="c"># If the file to patch was not found, take a look at the patch headers. For</span>
</span><span class='line'><span class="c"># example, if the header contains &quot;+++ themes/winstripe/calendar-views.css&quot;,</span>
</span><span class='line'><span class="c"># then you need to go into the base directory and call again. If the header</span>
</span><span class='line'><span class="c"># contains &quot;+++ mozilla/calendar/base/Makefile.in&quot;, you can use -p2 instead to</span>
</span><span class='line'><span class="c"># strip the &quot;mozilla/calendar&quot; part.</span>
</span><span class='line'>patch -p2 -i ~/my_first_bug.diff
</span></code></pre></td></tr></table></div></figure>


<h3>Creating a patch</h3>

<p>Simply create a diff and store it somewhere</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>bash<span class="nv">$ </span>hg diff &gt; ~/my_first_patch.diff
</span></code></pre></td></tr></table></div></figure>


<h3>Reverting a patch</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>bash<span class="nv">$ </span>hg revert .
</span></code></pre></td></tr></table></div></figure>


<p>For more information refer to <a href="https://developer.mozilla.org/en-US/docs/Developer_Guide/Build_Instructions">Mozilla Documentation on Build</a></p>

	</section>

  <footer class="post-footer">
  <section class="author">
    <h4>Mohit Kanwal</h4>
    <p></p>
  </section>
  <section class="share">
    <h4>Share this post</h4>
    <a class="icon-twitter" href="http://twitter.com/share?text=Essential Mozilla Command Line&amp;url=http://blog.mohitkanwal.com/blog/2013/01/11/essential-mozilla-command-line/" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
      <span class="hidden">Twitter</span>
    </a>
    <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=http://blog.mohitkanwal.com/blog/2013/01/11/essential-mozilla-command-line/" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
      <span class="hidden">Facebook</span>
    </a>
    <a class="icon-google-plus" href="https://plus.google.com/share?url=http://blog.mohitkanwal.com/blog/2013/01/11/essential-mozilla-command-line/" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
      <span class="hidden">Google+</span>
    </a>
  </section>
</footer>
  <hr>
  
    <div class="share">
</div>

  
  
  <section id="comment">
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>
  
</article></main>
  <footer class="site-footer"><a class="subscribe icon-feed" href="http://blog.mohitkanwal.com/atom.xml"><span class="tooltip">Subscribe!</span></a>


<div class="inner">


Follow me on



<a class="social twitter" href="http://twitter.com/mohitkanwal" title="Twitter">Twitter</a>



<a class="social github" href="http://github.com/creativepsyco" title="GitHub">GitHub</a>




<section class="copyright">All content copyright <a href="/">Mohit Kanwal</a> © 2016 • All rights reserved.</section>

<section class="poweredby">Casper theme by <a class="icon-ghost" href="http://tryghost.org">Ghost</a> &amp; Published with <a href="http://octopress.org">Octopress</a></section>

</div>
</footer>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad()</script>



<script type="text/javascript">
      var disqus_shortname = 'creativepyscoblog';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://blog.mohitkanwal.com/blog/2013/01/11/essential-mozilla-command-line/';
        var disqus_url = 'http://blog.mohitkanwal.com/blog/2013/01/11/essential-mozilla-command-line/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-36037120-1']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>


</body>
</html>
